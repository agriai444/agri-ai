import{d as Q,q as ve,v as K,ag as ie,a as ae,f as V,l as t,w as l,h as e,g as i,t as v,n as fe,e as T,ah as ge,ai as he,I as D,aj as ye,x as N,ak as we,al as te,am as _e,s as le,r as f,i as a,D as be,E as j,G,H as X,an as ee,z as $,aa as de,X as x,J as xe,ao as Ne,ap as Ue,aq as ke,ar as Y,o as Ce,F as se,as as $e,a8 as Z,ab as Ae,at as Se,a7 as Re,au as oe,_ as Me}from"./index-1cb71b58.js";import{N as ue}from"./Upload-49d6de9f.js";import{N as ce}from"./Switch-3e2d018f.js";import{N as pe}from"./Grid-21e37177.js";import{N as b}from"./FormItemGridItem-4af6fd44.js";import{N as ze}from"./AutoComplete-66c2e52d.js";import{a as me}from"./FormItem-50f38bb6.js";import{N as De}from"./Result-b6f586d6.js";const Fe={class:"flex gap-4 item-center"},qe={class:"flex flex-col"},Te={class:"font-bold text-base"},Ie={class:"w-36"},Le={class:"flex gap-3 item-end"},Ee={class:"text-xs"},Be={class:""},Oe={class:"text-yellow-400 font-bold"},Ke={class:"ml-4"},Ve={class:"flex gap-2 items-center"},je=i("div",null,"Created At:",-1),Ge={class:"ml-4"},Pe={class:"ml-4"},He={class:"flex gap-2 items-center"},Je=i("div",null,"Updated At:",-1),We={class:"ml-4"},Xe="research",Qe=Q({__name:"Card",props:{row:{}},setup(I){ve();const A=I,n=K(()=>A.row),U=`${ie}/${Xe}/${n.value.avatarUrl}`,k=n.value.state?"success":"error",{isMobile:S}=ae();return(y,s)=>(T(),V("div",Fe,[t(e(he),{dot:"",processing:!1,type:e(k)},{default:l(()=>[t(e(ge),{round:"",size:"medium",src:U})]),_:1},8,["type"]),i("div",qe,[i("div",Te,[t(e(ye),{"line-clamp":1},{tooltip:l(()=>[i("div",Ie,v(n.value.firstName)+" "+v(n.value.lastName),1)]),default:l(()=>[D(v(n.value.firstName)+" "+v(n.value.lastName)+" ",1)]),_:1})]),i("div",Le,[i("div",Ee,v(new Date(n.value.createdAt).toLocaleString()),1),t(e(we),{style:{maxWidth:"300px"},class:fe(e(S)?"ml-36":""),trigger:"hover",placement:"bottom"},{trigger:l(()=>[t(e(N),{icon:"ep:info-filled"})]),default:l(()=>[i("div",Be,[i("div",null,[t(e(N),{icon:"ep:info-filled",class:"inline-flex"}),D(" information about "),i("span",Oe,v(n.value.firstName),1)]),i("div",Ke,[i("div",Ve,[t(e(N),{icon:"lets-icons:date-today-duotone",class:"inline-flex"}),je]),i("div",Ge,v(new Date(n.value.createdAt).toLocaleString()),1)]),i("div",Pe,[i("div",He,[t(e(N),{icon:"lets-icons:date-today-duotone",class:"inline-flex"}),Je]),i("div",We,v(new Date(n.value.createdAt).toLocaleString()),1)])])]),_:1},8,["class"])])])]))}}),Ye={class:"border-none shadow-none flex flex-col gap-2 p-2 rounded-lg"},Ze={class:"post-heading mb-1"},ea={class:"gtext text-2xl font-bold underlined"},aa={style:{display:"flex","justify-content":"flex-end"}},ta="University",la="research",sa=Q({__name:"Add",props:{userType:{}},setup(I){const A=I,n=te(),U=_e(),k=le(),S=f(null),y=f(!1),s=f(n.initState()),{isMobile:u}=ae(),g=K(()=>u?24:12),R=f(null),L={firstName:[{required:!0,message:a("common.firstNameNameRequired"),trigger:["input","blur"]}],lastName:[{required:!0,message:a("common.lastNameRequired"),trigger:["input","blur"]}],email:[{required:!0,message:a("auth.emailRequired"),trigger:["input","blur"]}],password:[{required:!0,message:a("auth.passwordRequired"),trigger:["input","blur"]}]},M=async({file:p,data:o,headers:c,withCredentials:O,action:F,onFinish:C,onError:J,onProgress:W})=>{try{if(!o)throw new Error("dataParams is undefined");const q={loaded:20,total:100},d=Math.round(q.loaded*100/q.total);W({percent:d});const{data:r,error:h}=await de.storage.from(o.bucket).upload(`${o.folder}/${p.name}`,p.file,{cacheControl:"3600",upsert:!1});if(W({percent:Math.ceil(10)}),h)if(h.statusCode==="409"&&h.message==="Duplicate")s.value.avatarUrl=`${o.folder}/${p.name}`,C();else throw h;r&&(s.value.avatarUrl=r.path,C())}catch(q){console.log(q),k.error(q.message),J()}};function E(){return!s.value.firstName||!s.value.country}const B=p=>x("div",{style:{display:"flex",alignItems:"center"}},[x(N,{icon:"flagpack:"+(typeof p.value=="string"?p.value.toLowerCase():p.value),class:"w-6 h-6"}),x("span",{style:{marginLeft:"8px"}},p.label)]),m=[{label:"Male",value:"Male"},{label:"Female",value:"Female"},{label:"Other",value:"Other"}],_=K(()=>["@gmail.com"].map(p=>{const o=s.value.email.split("@")[0];return{label:o+p,value:o+p}}));function w(){var p;s.value.password&&((p=R.value)==null||p.validate({trigger:"password-input"}))}const P=be();async function H(){try{s.value.userType=A.userType,s.value.avatarUrl="",await P.signUp(s.value),y.value=!1,n.showModelAdd=!1,k.success(a("commn.addSuccess"))}catch(p){y.value=!1,console.error(a("common.addFailed"),p.message),k.error(a("common.addFailed"),p.message)}}function z(p){var o;p.preventDefault(),(o=S.value)==null||o.validate(c=>{if(c)k.error(a("auth.fillAllField")),y.value=!1;else if(xe(s.value.email))if(s.value.password&&s.value.password.length<8){k.error(a("auth.passwordLengthError")),y.value=!1;return}else y.value=!0,H();else{k.error(a("auth.invalidEmailFormat")),y.value=!1;return}})}return(p,o)=>(T(),V("div",Ye,[i("div",Ze,[i("div",ea,v(e(a)("common.addNew")),1)]),t(e(me),{ref_key:"formRef",ref:S,model:s.value,rules:L,size:"large"},{default:l(()=>[i("div",null,[t(e(pe),{span:g.value,"x-gap":24},{default:l(()=>[t(e(b),{span:g.value,path:"image",label:e(a)("common.image")},{default:l(()=>[t(e(ue),{accept:"image/*","list-type":"image-card",max:1,path:"image",data:{folder:ta,bucket:la},"custom-request":M},null,8,["data"])]),_:1},8,["span","label"]),t(e(b),{span:g.value,path:"firstName",label:e(a)("common.firstName")},{default:l(()=>[t(e(j),{value:s.value.firstName,"onUpdate:value":o[0]||(o[0]=c=>s.value.firstName=c),placeholder:e(a)("common.firstName"),clearable:"",onKeydown:o[1]||(o[1]=G(X(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["span","label"]),t(e(b),{span:g.value,path:"lastName",label:e(a)("common.lastName")},{default:l(()=>[t(e(j),{value:s.value.lastName,"onUpdate:value":o[2]||(o[2]=c=>s.value.lastName=c),placeholder:e(a)("common.lastName"),clearable:"",onKeydown:o[3]||(o[3]=G(X(()=>{},["prevent"]),["enter"]))},null,8,["value","placeholder"])]),_:1},8,["span","label"]),t(e(b),{span:g.value,path:"email",label:e(a)("auth.email")},{default:l(()=>[t(e(ze),{value:s.value.email,"onUpdate:value":o[5]||(o[5]=c=>s.value.email=c),"input-props":{autocomplete:"disabled"},options:_.value,size:"large",placeholder:"Email",clearable:""},{default:l(({handleInput:c,handleBlur:O,handleFocus:F,value:C})=>[t(e(j),{placeholder:"example@gmail.com",onKeydown:o[4]||(o[4]=G(X(()=>{},["prevent"]),["enter"])),value:C,onInput:c,onFocus:F,onBlur:O,size:"large"},{prefix:l(()=>[t(e(N),{icon:"ic:baseline-email",class:"text-md text-primary"})]),_:2},1032,["value","onInput","onFocus","onBlur"])]),_:1},8,["value","options"])]),_:1},8,["span","label"]),t(e(b),{span:g.value,ref_key:"passwordFormItemRef",ref:R,first:"",path:"password",label:e(a)("auth.password")},{default:l(()=>[t(e(j),{value:s.value.password,"onUpdate:value":o[6]||(o[6]=c=>s.value.password=c),"show-password-on":"click",onInput:w,type:"password",maxlength:20,onKeyup:G(z,["enter"])},{prefix:l(()=>[t(e(N),{icon:"mdi:password",class:"text-md text-primary"})]),"password-visible-icon":l(()=>[t(e(N),{icon:"mdi:show",class:"text-md text-primary"})]),"password-invisible-icon":l(()=>[t(e(N),{icon:"gridicons:not-visible",class:"text-md text-primary"})]),_:1},8,["value","onKeyup"])]),_:1},8,["span","label"]),t(e(b),{span:g.value,path:"gender",label:e(a)("common.gender")},{default:l(()=>[t(e(ee),{filterable:"",trigger:"hover",value:s.value.gender,"onUpdate:value":o[7]||(o[7]=c=>s.value.gender=c),options:m},{default:l(()=>[t(e($),null,{default:l(()=>[D(v(e(a)("common.gender")),1)]),_:1})]),_:1},8,["value"])]),_:1},8,["span","label"]),t(e(b),{span:g.value,path:"country",label:e(a)("common.country")},{default:l(()=>[t(e(ee),{filterable:"",trigger:"hover",value:s.value.country,"onUpdate:value":o[8]||(o[8]=c=>s.value.country=c),options:e(U).getCountryOption(),"render-label":B},{default:l(()=>[t(e($),null,{default:l(()=>[D(v(e(a)("common.country")),1)]),_:1})]),_:1},8,["value","options"])]),_:1},8,["span","label"]),t(e(b),{span:g.value,path:"state",label:e(a)("common.state")},{default:l(()=>[t(e(ce),{value:s.value.state,"onUpdate:value":o[9]||(o[9]=c=>s.value.state=c),size:"large"},null,8,["value"])]),_:1},8,["span","label"])]),_:1},8,["span"])]),i("div",aa,[t(e($),{type:"primary",style:{width:"100%"},size:"large",loading:y.value,disabled:E(),onClick:z},{default:l(()=>[D(v(e(a)("common.addNew")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["model"])]))}}),oa={class:"border-none shadow-none flex flex-col gap-2 p-2 rounded-lg"},ra={class:"post-heading mb-1"},na={class:"gtext text-2xl font-bold underlined"},ia={style:{display:"flex","justify-content":"flex-end"}},re="University",ne="research",da=Q({__name:"Update",props:{row:{}},setup(I){const A=te(),n=I,U=le(),S=Ne.getData().map(m=>({label:m.name,value:m.code,disabled:!1})),y=f(null),s=f(!1);f({id:n.row.id,firstName:n.row.firstName,lastName:n.row.lastName,country:n.row.country,state:n.row.state,avatarUrl:n.row.avatarUrl,createdAt:n.row.createdAt,updatedAt:n.row.updatedAt,email:null,password:null,dateOfBirth:null,gender:null,userType:null});const u=f({id:n.row.id,firstName:n.row.firstName,lastName:n.row.lastName,country:n.row.country,state:n.row.state,avatarUrl:n.row.avatarUrl,createdAt:n.row.createdAt,updatedAt:n.row.updatedAt,email:null,password:null,dateOfBirth:null,gender:null,userType:null}),g={name:[{required:!0,message:a("university.nameRequired"),trigger:["input","blur"]}],country:[{required:!0,message:a("university.countryRequired")}],image:[{required:!0,message:a("university.imageRequired"),trigger:["input","blur"]}]};async function R(){try{s.value=!0,await A.updateDataAction({id:n.row.id,updates:u.value}),s.value=!1,A.showModelUpdate=!1,U.success(a("commn.updateSuccess"))}catch(m){console.error(a("common.updateFailed"),m.message),U.error(a("common.updateFailed"))}}const L=async({file:m,data:_,headers:w,withCredentials:P,action:H,onFinish:z,onError:p,onProgress:o})=>{try{const c={loaded:20,total:100},O=Math.round(c.loaded*100/c.total);o({percent:O});const{data:F,error:C}=await de.storage.from(ne).upload(`${re}/${m.name}`,m.file,{cacheControl:"3600",upsert:!1});if(o({percent:Math.ceil(10)}),C)if(C.statusCode==="409"&&C.message==="Duplicate")u.value.avatarUrl=`${re}/${m.name}`,console.log("Resource already exists. Skipping upload."),z();else throw C;F&&(u.value.avatarUrl=F.path,z())}catch(c){console.log(c),U.error(c.message),p()}},M=f([{id:"pp",name:u.value.avatarUrl||"",status:"finished",url:`${ie}/${ne}/${u.value.avatarUrl}`}]);function E(){return!0}const B=m=>x("div",{style:{display:"flex",alignItems:"center"}},[x(N,{icon:"flagpack:"+(typeof m.value=="string"?m.value.toLowerCase():m.value),class:"w-6 h-6"}),x("span",{style:{marginLeft:"8px"}},m.label)]);return(m,_)=>(T(),V("div",oa,[i("div",ra,[i("div",na,v(e(a)("university.editUniversity")),1)]),t(e(me),{ref_key:"formRef",ref:y,model:u.value,rules:g,size:"large"},{default:l(()=>[i("div",null,[t(e(pe),{cols:4,span:24,"x-gap":24},{default:l(()=>[t(e(b),{span:12,path:"image",label:e(a)("university.image")},{default:l(()=>[t(e(ue),{accept:"image/*","list-type":"image-card",min:1,max:1,path:"image","default-file-list":M.value,"custom-request":L},null,8,["default-file-list"])]),_:1},8,["label"]),t(e(b),{span:12,path:"name",label:e(a)("university.universityName")},{default:l(()=>[t(e(j),{value:u.value.firstName,"onUpdate:value":_[0]||(_[0]=w=>u.value.firstName=w),placeholder:"University Name",clearable:"",onKeydown:_[1]||(_[1]=G(X(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},8,["label"]),t(e(b),{span:12,path:"country",label:e(a)("university.country")},{default:l(()=>[t(e(ee),{filterable:"",trigger:"hover",value:u.value.country,"onUpdate:value":_[2]||(_[2]=w=>u.value.country=w),options:e(S),"render-label":B},{default:l(()=>[t(e($),null,{default:l(()=>[D(v(e(a)("university.country")),1)]),_:1})]),_:1},8,["value","options"])]),_:1},8,["label"]),t(e(b),{span:12,path:"state",label:e(a)("university.state")},{default:l(()=>[t(e(ce),{value:u.value.state,"onUpdate:value":_[3]||(_[3]=w=>u.value.state=w),size:"large"},null,8,["value"])]),_:1},8,["label"])]),_:1})]),i("div",ia,[t(e($),{type:"primary",style:{width:"100%"},size:"large",loading:s.value,disabled:E(),onClick:R},{default:l(()=>[D(v(e(a)("university.editUniversity")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["model"])]))}}),ua={class:"container_dashboard"},ca={class:"header_dashboard"},pa={class:"flex gap-2 justify-end items-center my-2"},ma={class:"flex gap-2 items-center"},va={class:"hidden md:block"},fa={class:"flex gap-2 items-center"},ga={class:"hidden md:block"},ha={class:""},ya={key:0,class:"border-red-400 bg-red-100 p-4 rounded-lg"},wa=Q({__name:"List",setup(I){const{iconRender:A}=$e(),n=Ue();let{userType:U}=n.params;const k=f(!1),S=f(!1),y=f(!0),s=f(!1),u=te(),g=f([]),{isMobile:R}=ae(),L=ke(),M=le(),E=f(null),B=K(()=>{const d=(w.page-1)*w.pageSize,r=d+w.pageSize;return u.listUsers.slice(d,r).filter(h=>h.userType===U)}),m=f(10),_=K(()=>u.countTotalData),w=Y({page:1,pageCount:K(()=>Math.ceil(_.value/m.value)),pageSize:m.value});function P(d){const r=L.warning({title:a("chat.deleteConfirmation"),content:a("chat.deleteConfirmationMessage"),positiveText:a("common.yes"),negativeText:a("common.no"),onPositiveClick:async()=>{try{r.loading=!0,await u.deleteDataAction(d.id),M.success(a("chat.deleteSuccess"))}catch{r.loading=!1,M.error(a("chat.deleteFailed"))}finally{r.loading=!1}}})}async function H(d){u.showModelUpdate=!0,E.value=d}const z=Y({title:a("common.users"),key:"users",render(d){return x(Qe,{row:d})}}),p=Y([{type:"selection"},z,{title:a("common.actions"),key:"actions",align:"center",width:100,render(d){return x("div",{class:"flex gap-1"},[x($,{strong:!0,tertiary:!0,disabled:!0,size:"small",loading:S.value,style:"border-radius:100%",onClick:async()=>{try{await H(d)}catch(r){console.error(a("common.updateFailed"),r.message)}}},{default:()=>x(A({icon:"fluent:edit-32-regular",color:"blue"}))}),x($,{strong:!0,tertiary:!0,size:"small",loading:k.value,onClick:()=>P(d)},{default:()=>x(A({icon:"fluent:delete-32-regular",color:"red"}))})])}}]);async function o(){try{y.value=!0;const{page:d,pageSize:r}=w;await u.fetchDataAction({limit:1e3,offset:0,userType:U}),y.value=!1,s.value=!1}catch(d){s.value=!0,console.error(a("chat.dataFetchError"),d.message)}finally{y.value=!1}}Ce(async()=>{await o(),console.log(B.value)}),f(null);function c(d,r){z.filterOptionValue=d[r.key]}const O=f(p);function F(d){O.value.forEach(r=>{if(r.sortOrder!==void 0){if(!d){r.sortOrder=!1;return}r.key===d.columnKey?r.sortOrder=d.order:r.sortOrder=!1}})}const C=d=>d.id;function J(d){g.value=d}function W(){const d=L.warning({title:a("chat.deleteConfirmation"),content:a("chat.deleteConfirmationMessage"),positiveText:a("common.yes"),negativeText:a("common.no"),onPositiveClick:async()=>{try{d.loading=!0;const r=g.value.map(h=>u.deleteDataAction(h));await Promise.all(r),M.success(a("chat.deleteSuccess"))}catch(r){console.error(a("common.deleteFailed"),r.message),M.error(a("common.deleteFailed"))}finally{d.loading=!1}}})}function q(d){w.page=d,o()}return(d,r)=>(T(),V(se,null,[i("div",ua,[i("div",ca,v(e(a)("common.users")),1),i("div",pa,[t(e($),{onClick:r[0]||(r[0]=h=>e(u).showModelAdd=!0),type:"primary"},{default:l(()=>[i("div",ma,[t(e(N),{icon:"mdi:add-bold",class:"text-base"}),i("div",va,v(e(a)("common.add")),1)])]),_:1}),t(e($),{strong:"",secondary:"",type:"error",disabled:!(g.value.length>0),onClick:W},{default:l(()=>[i("div",fa,[t(e(N),{icon:"fluent:delete-32-regular",class:"text-base"}),i("div",ga,v(e(a)("common.delete")),1)])]),_:1},8,["disabled"])]),i("div",ha,[t(e(Re),{vertical:"",size:12},{default:l(()=>[s.value?(T(),V("div",ya,[t(e(De),{status:"error",title:"Error",description:"It's red"},{footer:l(()=>[t(e($),{size:"small",loading:y.value,onClick:r[1]||(r[1]=h=>o())},{default:l(()=>[D(v(e(a)("common.tryAgain")),1)]),_:1},8,["loading"])]),_:1})])):Z("",!0),s.value?Z("",!0):(T(),V(se,{key:1},[s.value?Z("",!0):(T(),Ae(e(Se),{key:0,"min-height":e(R)?380:540,"max-height":e(R)?400:700,size:(e(R),"small"),"checked-row-keys":g.value,"onUpdate:checkedRowKeys":[r[2]||(r[2]=h=>g.value=h),J],striped:"",loading:y.value,columns:p,data:B.value,"onUpdate:page":q,pagination:w,"row-key":C,remote:"","onUpdate:filters":c,"onUpdate:sorter":F},null,8,["min-height","max-height","size","checked-row-keys","loading","columns","data","pagination"]))],64))]),_:1})])]),i("div",null,[t(e(oe),{show:e(u).showModelAdd,"onUpdate:show":r[3]||(r[3]=h=>e(u).showModelAdd=h),"mask-closable":!1,"auto-focus":!1,preset:"card",style:{width:"95%","max-width":"640px"}},{default:l(()=>[t(sa,{userType:e(U)},null,8,["userType"])]),_:1},8,["show"]),t(e(oe),{show:e(u).showModelUpdate,"onUpdate:show":r[4]||(r[4]=h=>e(u).showModelUpdate=h),"mask-closable":!1,"auto-focus":!1,preset:"card",style:{width:"95%","max-width":"640px"}},{default:l(()=>[t(da,{row:E.value},null,8,["row"])]),_:1},8,["show"])])],64))}});const Sa=Me(wa,[["__scopeId","data-v-8f18d402"]]);export{Sa as default};
