import{d as E,bh as de,v as N,bi as ae,a as se,f as B,l as t,w as l,h as e,g as a,t as f,n as ce,e as A,ag as ue,ah as me,I as L,ai as ve,x as g,aj as pe,an as oe,r as p,i as s,z as D,am as le,bj as K,bk as _e,s as X,bl as fe,a7 as ne,X as U,ak as ie,E as ge,G as he,H as ye,aa as be,ap as we,aq as W,o as xe,F as $e,ar as Ce,a8 as Q,ab as ke,at as Se,au as Y,_ as Ue}from"./index-47c41640.js";import{N as re,a as P}from"./Grid-4ecf25cd.js";import{_ as Ne}from"./AddUniversity.vue_vue_type_script_setup_true_lang-c429828f.js";import{N as H}from"./FormItemGridItem-377b31b6.js";import{N as De}from"./Upload-2f21830d.js";import{N as ze}from"./Switch-fa214c30.js";import{N as Re}from"./Form-e99ccaf8.js";import{N as Oe}from"./Result-e618330d.js";import"./FormItem-c6ae1884.js";const Ae={class:"flex gap-4 item-center"},Fe={class:"flex flex-col"},Te={class:"font-bold text-base"},Ie={class:"w-36"},Be={class:"flex gap-3 item-end"},Le={class:"text-xs"},Me={class:""},je={class:"text-yellow-400 font-bold"},qe={class:"ml-4"},Ve={class:"flex gap-2 items-center"},Ee=a("div",null,"Created At:",-1),Ge={class:"ml-4"},Ke={class:"ml-4"},Pe={class:"flex gap-2 items-center"},He=a("div",null,"Updated At:",-1),Je={class:"ml-4"},We="research",Xe=E({__name:"CardUnversity",props:{row:{}},setup(R){de();const $=R,o=N(()=>$.row),w=`${ae}/${We}/${o.value.image_url}`,h=o.value.is_active?"success":"error",{isMobile:d}=se();return(m,u)=>(A(),B("div",Ae,[t(e(me),{dot:"",processing:!1,type:e(h)},{default:l(()=>[t(e(ue),{round:"",size:"medium",src:w})]),_:1},8,["type"]),a("div",Fe,[a("div",Te,[t(e(ve),{"line-clamp":1},{tooltip:l(()=>[a("div",Ie,f(o.value.name),1)]),default:l(()=>[L(f(o.value.name)+" ",1)]),_:1})]),a("div",Be,[a("div",Le,f(new Date(o.value.created_at).toLocaleString()),1),t(e(pe),{style:{maxWidth:"300px"},class:ce(e(d)?"ml-36":""),trigger:"hover",placement:"bottom"},{trigger:l(()=>[t(e(g),{icon:"ep:info-filled"})]),default:l(()=>[a("div",Me,[a("div",null,[t(e(g),{icon:"ep:info-filled",class:"inline-flex"}),L(" information about "),a("span",je,f(o.value.name),1)]),a("div",qe,[a("div",Ve,[t(e(g),{icon:"lets-icons:date-today-duotone",class:"inline-flex"}),Ee]),a("div",Ge,f(new Date(o.value.created_at).toLocaleString()),1)]),a("div",Ke,[a("div",Pe,[t(e(g),{icon:"lets-icons:date-today-duotone",class:"inline-flex"}),He]),a("div",Je,f(new Date(o.value.updated_at).toLocaleString()),1)])])]),_:1},8,["class"])])])]))}}),Qe={class:"flex flex-col gap-2 p-4"},Ye={class:"flex gap-2 items-center"},Ze=a("div",{class:"font-bold"},"Filter",-1),et={class:"ml-4"},tt={class:"flex flex-col gap-2 p-2"},at={class:"flex gap-2 items-center"},st=a("div",{class:"font-bold"},"Sort",-1),ot={class:"ml-4"},lt={class:"flex justify-around"},nt=a("div",null,"Sort By Date",-1),it={class:"flex gap-2 justify-between"},rt={class:"flex gap-2 items-center"},dt=a("div",null,"Clear Filters",-1),ct={class:"flex gap-2 items-center"},ut=a("div",null,"Clear Sorter",-1),mt=E({__name:"OptionFilter",props:{mainColumn:{},columns:{}},setup(R){const o=oe.getData().map(c=>({label:c.name,value:c.code,disabled:!1})),w=p(null),h=R,d=N(()=>h.mainColumn),m=N(()=>h.columns),u=p("ascend"),y=p("ascend"),r=()=>{u.value=u.value==="ascend"?"descend":"ascend",q(u.value)},z=()=>{y.value=u.value==="ascend"?"descend":"ascend",v(y.value)},F=N(()=>u.value==="ascend"?s("Sort By Name"):s("Sort By Name")),M=N(()=>u.value==="ascend"?"bi:sort-up":"bi:sort-down"),j=N(()=>y.value==="ascend"?"bi:sort-up":"bi:sort-down");function O(){d.value.filterOptionValue=null}p(m);function q(c){d.value.sorter={compare:(b,C)=>b.name.length-C.name.length,multiple:2},d.value.sortOrder=c}function v(c){d.value.sorter={compare:(b,C)=>{const k=new Date(b.updated_at),T=new Date(C.updated_at);return k<T?c==="ascend"?-1:1:k>T?c==="ascend"?1:-1:0},multiple:3},d.value.sortOrder=c}function _(){d.value.sortOrder=!1}const x=(c,b)=>~b.country.indexOf(c);function V(c,b){d.value.filterOptionValue=c,d.value.filter=x}function J(c){citiesRef.value=c,message.info(JSON.stringify(c))}return(c,b)=>(A(),B("div",Qe,[a("div",null,[a("div",Ye,[t(e(g),{icon:"solar:filter-bold-duotone"}),Ze]),a("div",et,[a("div",tt,[t(e(le),{filterable:"",multiple:"",trigger:"hover","onUpdate:value":V,options:e(o),"consistent-menu-width":!1,"max-tag-count":2},{default:l(()=>[t(e(D),null,{default:l(()=>[L(f(e(s)("university.country")),1)]),_:1})]),_:1},8,["options"]),t(e(_e),{value:w.value,"onUpdate:value":[b[0]||(b[0]=C=>w.value=C),J]},{default:l(()=>[t(e(re),{"y-gap":8,cols:2},{default:l(()=>[t(e(P),null,{default:l(()=>[t(e(K),{value:"Beijing",label:"Beijing"})]),_:1}),t(e(P),null,{default:l(()=>[t(e(K),{value:"Shanghai",label:"Shanghai"})]),_:1}),t(e(P),null,{default:l(()=>[t(e(K),{value:"Guangzhou",label:"Guangzhou"})]),_:1}),t(e(P),null,{default:l(()=>[t(e(K),{value:"Shenzen",label:"Shenzhen"})]),_:1})]),_:1})]),_:1},8,["value"])])])]),a("div",null,[a("div",at,[t(e(g),{icon:"ic:twotone-sort",class:"text-base"}),st]),a("div",ot,[a("div",lt,[a("div",{onClick:r,class:"flex gap-2 items-center cursor-pointer"},[t(e(g),{icon:M.value,class:"text-base"},null,8,["icon"]),a("div",null,f(F.value),1)]),a("div",{onClick:z,class:"flex gap-2 items-center cursor-pointer"},[t(e(g),{icon:j.value,class:"text-base"},null,8,["icon"]),nt])])])]),a("div",it,[t(e(D),{strong:"",secondary:"",type:"error",onClick:O},{default:l(()=>[a("div",rt,[t(e(g),{icon:"flat-color-icons:clear-filters",class:"text-base"}),dt])]),_:1}),t(e(D),{strong:"",secondary:"",type:"error",onClick:_},{default:l(()=>[a("div",ct,[t(e(g),{icon:"carbon:sort-remove",class:"text-base"}),ut])]),_:1})])]))}}),vt={class:"flex justify-end p-2"},pt={class:"flex rounded-full p-2 justify-center items-start bg-blue-200"},_t=E({__name:"FilterTable",props:{mainColumn:{},columns:{}},setup(R){const $=R,o=N(()=>$.mainColumn),w=N(()=>$.columns),h=X(),d=[{key:"header",type:"render",render:()=>U(mt,{mainColumn:o.value,columns:w.value})}];function m(u){h.info(String(u))}return(u,y)=>(A(),B("div",vt,[t(e(ne),null,{default:l(()=>[t(e(fe),{trigger:"click",options:d,onSelect:m},{default:l(()=>[a("div",pt,[t(e(g),{icon:"solar:filter-bold-duotone",class:"text-xl"})])]),_:1})]),_:1})]))}}),ft={class:"border-none shadow-none flex flex-col gap-2 p-2 rounded-lg"},gt={class:"post-heading mb-1"},ht={class:"gtext text-2xl font-bold underlined"},yt={style:{display:"flex","justify-content":"flex-end"}},Z="University",ee="research",bt=E({__name:"UpdateUnversity",props:{row:{}},setup(R){const $=ie(),o=R,w=X(),d=oe.getData().map(v=>({label:v.name,value:v.code,disabled:!1})),m=p(null),u=p(!1),y=p({id:o.row.id,name:o.row.name,country_code:o.row.country_code,is_active:o.row.is_active,user_id:o.row.user_id,type_added:o.row.type_added,image_url:o.row.image_url,created_at:o.row.created_at,updated_at:o.row.updated_at}),r=p({id:o.row.id,name:o.row.name,country_code:o.row.country_code,is_active:o.row.is_active,user_id:o.row.user_id,type_added:o.row.type_added,image_url:o.row.image_url,created_at:o.row.created_at,updated_at:o.row.updated_at}),z={name:[{required:!0,message:s("university.nameRequired"),trigger:["input","blur"]}],country:[{required:!0,message:s("university.countryRequired")}],image:[{required:!0,message:s("university.imageRequired"),trigger:["input","blur"]}]};async function F(){try{u.value=!0,await $.updateDataAction({id:o.row.id,updates:r.value}),u.value=!1,$.showUpdate=!1,w.success(s("commn.updateSuccess"))}catch(v){console.error(s("common.updateFailed"),v.message),w.error(s("common.updateFailed"))}}const M=async({file:v,data:_,headers:x,withCredentials:V,action:J,onFinish:c,onError:b,onProgress:C})=>{try{const k={loaded:20,total:100},T=Math.round(k.loaded*100/k.total);C({percent:T});const{data:G,error:I}=await be.storage.from(ee).upload(`${Z}/${v.name}`,v.file,{cacheControl:"3600",upsert:!1});if(C({percent:Math.ceil(10)}),I)if(I.statusCode==="409"&&I.error==="Duplicate")r.value.image_url=`${Z}/${v.name}`,console.log("Resource already exists. Skipping upload."),c();else throw I;G&&(r.value.image_url=G.path,c())}catch(k){console.log(k),w.error(k.message),b()}},j=p([{id:"pp",name:r.value.image_url||"",status:"finished",url:`${ae}/${ee}/${r.value.image_url}`}]);function O(){return!r.value.name||!r.value.country_code||!r.value.image_url||r.value.name===y.value.name&&r.value.country_code===y.value.country_code&&r.value.is_active===y.value.is_active&&r.value.image_url===y.value.image_url}const q=v=>U("div",{style:{display:"flex",alignItems:"center"}},[U(g,{icon:"flagpack:"+(typeof v.value=="string"?v.value.toLowerCase():v.value),class:"w-6 h-6"}),U("span",{style:{marginLeft:"8px"}},v.label)]);return(v,_)=>(A(),B("div",ft,[a("div",gt,[a("div",ht,f(e(s)("university.editUniversity")),1)]),t(e(Re),{ref_key:"formRef",ref:m,model:r.value,rules:z,size:"large"},{default:l(()=>[a("div",null,[t(e(re),{cols:4,span:24,"x-gap":24},{default:l(()=>[t(e(H),{span:12,path:"image",label:e(s)("university.image")},{default:l(()=>[t(e(De),{accept:"image/*","list-type":"image-card",min:1,max:1,path:"image","default-file-list":j.value,"custom-request":M},null,8,["default-file-list"])]),_:1},8,["label"]),t(e(H),{span:12,path:"name",label:e(s)("university.universityName")},{default:l(()=>[t(e(ge),{value:r.value.name,"onUpdate:value":_[0]||(_[0]=x=>r.value.name=x),placeholder:"University Name",clearable:"",onKeydown:_[1]||(_[1]=he(ye(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},8,["label"]),t(e(H),{span:12,path:"country",label:e(s)("university.country")},{default:l(()=>[t(e(le),{filterable:"",trigger:"hover",value:r.value.country_code,"onUpdate:value":_[2]||(_[2]=x=>r.value.country_code=x),options:e(d),"render-label":q},{default:l(()=>[t(e(D),null,{default:l(()=>[L(f(e(s)("university.country")),1)]),_:1})]),_:1},8,["value","options"])]),_:1},8,["label"]),t(e(H),{span:12,path:"state",label:e(s)("university.state")},{default:l(()=>[t(e(ze),{value:r.value.is_active,"onUpdate:value":_[3]||(_[3]=x=>r.value.is_active=x),size:"large"},null,8,["value"])]),_:1},8,["label"])]),_:1})]),a("div",yt,[t(e(D),{type:"primary",style:{width:"100%"},size:"large",loading:u.value,disabled:O(),onClick:F},{default:l(()=>[L(f(e(s)("university.editUniversity")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["model"])]))}}),wt={class:"container_dashboard"},xt={class:"header_dashboard"},$t={class:"flex gap-2 justify-end items-center"},Ct={class:"flex gap-2 items-center"},kt={class:"hidden md:block"},St={class:"flex gap-2 items-center"},Ut={class:"hidden md:block"},Nt={class:"cursor-pointer"},Dt={class:""},zt={key:0,class:"border-red-400 bg-red-100 p-4 rounded-lg"},te=3,Rt=E({__name:"ListUniversity",setup(R){const{iconRender:$}=Ce(),o=p(!1),w=p(!1),h=p(!0),d=p(!1),m=ie(),u=p([]),{isMobile:y}=se(),r=we(),z=X(),F=p(null),M=N(()=>m.listUsers),j=N(()=>m.countTotalData),O=W({page:j,pageSize:te,showSizePicker:!0,onChange:n=>{O.page=n},onUpdatePageSize:n=>{O.pageSize=n,O.page=1}});function q(n){const i=r.warning({title:s("chat.deleteConfirmation"),content:s("chat.deleteConfirmationMessage"),positiveText:s("common.yes"),negativeText:s("common.no"),onPositiveClick:async()=>{try{i.loading=!0,await m.deleteDataAction(n.id),z.success(s("chat.deleteSuccess"))}catch{i.loading=!1,z.error(s("chat.deleteFailed"))}finally{i.loading=!1}}})}async function v(n){m.showUpdate=!0,F.value=n}const _=W({title:s("university.university"),key:"university",render(n){return U(Xe,{row:n})}}),x=W([{type:"selection",options:["all","none"],disabled(n){return n.type_added==="default"}},_,{title:s("research.actions"),key:"actions",align:"center",width:100,render(n){return U("div",{class:"flex gap-1"},[U(D,{strong:!0,tertiary:!0,size:"small",loading:w.value,style:"border-radius:100%",onClick:async()=>{try{await v(n)}catch(i){console.error(s("common.updateFailed"),i.message)}}},{default:()=>U($({icon:"fluent:edit-32-regular",color:"blue"}))}),U(D,{strong:!0,tertiary:!0,size:"small",loading:o.value,onClick:()=>q(n)},{default:()=>U($({icon:"fluent:delete-32-regular",color:"red"}))})])}}]);async function V(){try{await m.fetchDataAction({limit:te,offset:1}),h.value=!0,h.value=!1,d.value=!1}catch(n){z.error(s("common.errorSomeThing")+" "+n.message),console.error(s("common.errorSomeThing"),n.message),console.error(d.value),d.value=!0,console.error(d.value),h.value=!1}}xe(async()=>{V()});const c=p(null);function b(n,i){_.filterOptionValue=n[i.key]}const C=p(x);function k(n){C.value.forEach(i=>{if(i.sortOrder!==void 0){if(!n){i.sortOrder=!1;return}i.key===n.columnKey?i.sortOrder=n.order:i.sortOrder=!1}})}const T=n=>n.id;function G(n){u.value=n}function I(){const n=r.warning({title:s("chat.deleteConfirmation"),content:s("chat.deleteConfirmationMessage"),positiveText:s("common.yes"),negativeText:s("common.no"),onPositiveClick:async()=>{try{n.loading=!0;const i=u.value.map(S=>m.deleteDataAction(S));await Promise.all(i),z.success(s("chat.deleteSuccess"))}catch(i){console.error(s("common.deleteFailed"),i.message),z.error(s("common.deleteFailed"))}finally{n.loading=!1}}})}return(n,i)=>(A(),B($e,null,[a("div",wt,[a("div",xt,f(e(s)("university.universitys")),1),a("div",$t,[t(e(D),{onClick:i[0]||(i[0]=S=>e(m).showAdd=!0),type:"primary"},{default:l(()=>[a("div",Ct,[t(e(g),{icon:"mdi:add-bold",class:"text-base"}),a("div",kt,f(e(s)("university.addUniversity")),1)])]),_:1}),t(e(D),{strong:"",secondary:"",type:"error",disabled:!(u.value.length>0),onClick:I},{default:l(()=>[a("div",St,[t(e(g),{icon:"fluent:delete-32-regular",class:"text-base"}),a("div",Ut,f(e(s)("common.delete")),1)])]),_:1},8,["disabled"]),a("div",Nt,[t(e(_t),{mainColumn:_,columns:x},null,8,["mainColumn","columns"])])]),a("div",Dt,[t(e(ne),{vertical:"",size:12},{default:l(()=>[d.value?(A(),B("div",zt,[t(e(Oe),{status:"error",title:"Error",description:"It's red"},{footer:l(()=>[t(e(D),{size:"small",loading:h.value,onClick:i[1]||(i[1]=S=>V())},{default:l(()=>[L(" try Again ")]),_:1},8,["loading"])]),_:1})])):Q("",!0),d.value?Q("",!0):(A(),ke(e(Se),{key:1,remote:"",size:(e(y),"small"),striped:"",loading:h.value,ref_key:"dataTableInst",ref:c,columns:x,data:M.value,pagination:O,"max-height":e(y)?400:370,"min-height":e(y)?380:370,"paginate-single-page":!1,"checked-row-keys":u.value,"onUpdate:checkedRowKeys":[i[2]||(i[2]=S=>u.value=S),G],"onUpdate:filters":b,"onUpdate:sorter":k,"row-key":T},null,8,["size","loading","columns","data","pagination","max-height","min-height","checked-row-keys"]))]),_:1})])]),a("div",null,[t(e(Y),{show:e(m).showAdd,"onUpdate:show":i[3]||(i[3]=S=>e(m).showAdd=S),"mask-closable":!1,"auto-focus":!1,preset:"card",style:{width:"95%","max-width":"640px"}},{default:l(()=>[t(Ne)]),_:1},8,["show"]),t(e(Y),{show:e(m).showUpdate,"onUpdate:show":i[4]||(i[4]=S=>e(m).showUpdate=S),"mask-closable":!1,"auto-focus":!1,preset:"card",style:{width:"95%","max-width":"640px"}},{default:l(()=>[t(bt,{row:F.value},null,8,["row"])]),_:1},8,["show"])])],64))}});const qt=Ue(Rt,[["__scopeId","data-v-af724ed6"]]);export{qt as default};
