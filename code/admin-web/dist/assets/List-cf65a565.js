import{d as Y,X as w,P as Ne,K as q,Q as We,R as fe,aR as rt,aS as ut,aw as dt,r as U,ax as ct,ay as mt,aT as J,A as pt,T as ft,v as $,aU as vt,E as B,a5 as _e,aV as Be,$ as ze,a0 as $e,aW as Fe,aX as gt,aN as ee,aY as ht,aZ as bt,M as Ke,a_ as yt,a$ as xt,V as wt,W as Ct,b0 as kt,b1 as It,b2 as Dt,aH as St,a as ve,b3 as Pe,aP as Ae,s as Ve,i as t,o as ge,e as G,f as ie,g as P,t as z,h as e,l as n,w as d,an as ae,G as V,H as W,z as Q,I as he,aQ as Te,ab as Re,ah as Ut,ai as Nt,aj as Rt,aq as Pt,ar as pe,as as At,a7 as Oe,x as Ee,at as Vt,au as je}from"./index-1cb71b58.js";import{N as Ge}from"./Grid-21e37177.js";import{N as k}from"./FormItemGridItem-4af6fd44.js";import{N as re}from"./Switch-3e2d018f.js";import{a as Xe}from"./FormItem-50f38bb6.js";import{N as te}from"./text-9b103bb8.js";import{N as Tt}from"./Result-b6f586d6.js";const Mt=Y({name:"Remove",render(){return w("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},w("line",{x1:"400",y1:"256",x2:"112",y2:"256",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))}});function _t(a){return a==null||typeof a=="string"&&a.trim()===""?null:Number(a)}function Bt(a){return a.includes(".")&&(/^(-)?\d+.*(\.|0)$/.test(a)||/^\.\d+$/.test(a))}function Se(a){return a==null?!0:!Number.isNaN(a)}function He(a,h){return a==null?"":h===void 0?String(a):a.toFixed(h)}function Ue(a){if(a===null)return null;if(typeof a=="number")return a;{const h=Number(a);return Number.isNaN(h)?null:h}}const zt=Ne([q("input-number-suffix",`
 display: inline-block;
 margin-right: 10px;
 `),q("input-number-prefix",`
 display: inline-block;
 margin-left: 10px;
 `)]),Le=800,qe=100,$t=Object.assign(Object.assign({},fe.props),{autofocus:Boolean,loading:{type:Boolean,default:void 0},placeholder:String,defaultValue:{type:Number,default:null},value:Number,step:{type:[Number,String],default:1},min:[Number,String],max:[Number,String],size:String,disabled:{type:Boolean,default:void 0},validator:Function,bordered:{type:Boolean,default:void 0},showButton:{type:Boolean,default:!0},buttonPlacement:{type:String,default:"right"},readonly:Boolean,clearable:Boolean,keyboard:{type:Object,default:{}},updateValueOnInput:{type:Boolean,default:!0},parse:Function,format:Function,precision:Number,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onChange:[Function,Array]}),O=Y({name:"InputNumber",props:$t,setup(a){const{mergedBorderedRef:h,mergedClsPrefixRef:p,mergedRtlRef:f}=We(a),b=fe("InputNumber","-input-number",zt,rt,a,p),{localeRef:C}=ut("InputNumber"),y=dt(a),{mergedSizeRef:S,mergedDisabledRef:o,mergedStatusRef:N}=y,s=U(null),M=U(null),F=U(null),T=U(a.defaultValue),E=ct(a,"value"),g=mt(E,T),D=U(""),r=l=>{const m=String(l).split(".")[1];return m?m.length:0},i=l=>{const m=[a.min,a.max,a.step,l].map(x=>x===void 0?0:r(x));return Math.max(...m)},u=J(()=>{const{placeholder:l}=a;return l!==void 0?l:C.value.placeholder}),c=J(()=>{const l=Ue(a.step);return l!==null?l===0?1:Math.abs(l):1}),ue=J(()=>{const l=Ue(a.min);return l!==null?l:null}),de=J(()=>{const l=Ue(a.max);return l!==null?l:null}),X=l=>{const{value:m}=g;if(l===m){H();return}const{"onUpdate:value":x,onUpdateValue:R,onChange:K}=a,{nTriggerFormInput:j,nTriggerFormChange:Z}=y;K&&ee(K,l),R&&ee(R,l),x&&ee(x,l),T.value=l,j(),Z()},_=({offset:l,doUpdateIfValid:m,fixPrecision:x,isInputing:R})=>{const{value:K}=D;if(R&&Bt(K))return!1;const j=(a.parse||_t)(K);if(j===null)return m&&X(null),null;if(Se(j)){const Z=r(j),{precision:se}=a;if(se!==void 0&&se<Z&&!x)return!1;let L=parseFloat((j+l).toFixed(se??i(j)));if(Se(L)){const{value:Ie}=de,{value:De}=ue;if(Ie!==null&&L>Ie){if(!m||R)return!1;L=Ie}if(De!==null&&L<De){if(!m||R)return!1;L=De}return a.validator&&!a.validator(L)?!1:(m&&X(L),L)}}return!1},H=()=>{const{value:l}=g;if(Se(l)){const{format:m,precision:x}=a;m?D.value=m(l):l===null||x===void 0||r(l)>x?D.value=He(l,void 0):D.value=He(l,x)}else D.value=String(l)};H();const v=J(()=>_({offset:0,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})===!1),I=J(()=>{const{value:l}=g;if(a.validator&&l===null)return!1;const{value:m}=c;return _({offset:-m,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})!==!1}),A=J(()=>{const{value:l}=g;if(a.validator&&l===null)return!1;const{value:m}=c;return _({offset:+m,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})!==!1});function le(l){const{onFocus:m}=a,{nTriggerFormFocus:x}=y;m&&ee(m,l),x()}function be(l){var m,x;if(l.target===((m=s.value)===null||m===void 0?void 0:m.wrapperElRef))return;const R=_({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0});if(R!==!1){const Z=(x=s.value)===null||x===void 0?void 0:x.inputElRef;Z&&(Z.value=String(R||"")),g.value===R&&H()}else H();const{onBlur:K}=a,{nTriggerFormBlur:j}=y;K&&ee(K,l),j(),ht(()=>{H()})}function ye(l){const{onClear:m}=a;m&&ee(m,l)}function xe(){const{value:l}=A;if(!l){ke();return}const{value:m}=g;if(m===null)a.validator||X(Me());else{const{value:x}=c;_({offset:x,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})}}function we(){const{value:l}=I;if(!l){Ce();return}const{value:m}=g;if(m===null)a.validator||X(Me());else{const{value:x}=c;_({offset:-x,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})}}const Je=le,Qe=be;function Me(){if(a.validator)return null;const{value:l}=ue,{value:m}=de;return l!==null?Math.max(0,l):m!==null?Math.min(0,m):0}function Ye(l){ye(l),X(null)}function Ze(l){var m,x,R;!((m=F.value)===null||m===void 0)&&m.$el.contains(l.target)&&l.preventDefault(),!((x=M.value)===null||x===void 0)&&x.$el.contains(l.target)&&l.preventDefault(),(R=s.value)===null||R===void 0||R.activate()}let ne=null,oe=null,ce=null;function Ce(){ce&&(window.clearTimeout(ce),ce=null),ne&&(window.clearInterval(ne),ne=null)}function ke(){me&&(window.clearTimeout(me),me=null),oe&&(window.clearInterval(oe),oe=null)}function et(){Ce(),ce=window.setTimeout(()=>{ne=window.setInterval(()=>{we()},qe)},Le),Be("mouseup",document,Ce,{once:!0})}let me=null;function tt(){ke(),me=window.setTimeout(()=>{oe=window.setInterval(()=>{xe()},qe)},Le),Be("mouseup",document,ke,{once:!0})}const at=()=>{oe||xe()},lt=()=>{ne||we()};function nt(l){var m,x;if(l.key==="Enter"){if(l.target===((m=s.value)===null||m===void 0?void 0:m.wrapperElRef))return;_({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&((x=s.value)===null||x===void 0||x.deactivate())}else if(l.key==="ArrowUp"){if(!A.value||a.keyboard.ArrowUp===!1)return;l.preventDefault(),_({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&xe()}else if(l.key==="ArrowDown"){if(!I.value||a.keyboard.ArrowDown===!1)return;l.preventDefault(),_({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&we()}}function ot(l){D.value=l,a.updateValueOnInput&&!a.format&&!a.parse&&a.precision===void 0&&_({offset:0,doUpdateIfValid:!0,isInputing:!0,fixPrecision:!1})}pt(g,()=>{H()});const st={focus:()=>{var l;return(l=s.value)===null||l===void 0?void 0:l.focus()},blur:()=>{var l;return(l=s.value)===null||l===void 0?void 0:l.blur()},select:()=>{var l;return(l=s.value)===null||l===void 0?void 0:l.select()}},it=ft("InputNumber",f,p);return Object.assign(Object.assign({},st),{rtlEnabled:it,inputInstRef:s,minusButtonInstRef:M,addButtonInstRef:F,mergedClsPrefix:p,mergedBordered:h,uncontrolledValue:T,mergedValue:g,mergedPlaceholder:u,displayedValueInvalid:v,mergedSize:S,mergedDisabled:o,displayedValue:D,addable:A,minusable:I,mergedStatus:N,handleFocus:Je,handleBlur:Qe,handleClear:Ye,handleMouseDown:Ze,handleAddClick:at,handleMinusClick:lt,handleAddMousedown:tt,handleMinusMousedown:et,handleKeyDown:nt,handleUpdateDisplayedValue:ot,mergedTheme:b,inputThemeOverrides:{paddingSmall:"0 8px 0 10px",paddingMedium:"0 8px 0 12px",paddingLarge:"0 8px 0 14px"},buttonThemeOverrides:$(()=>{const{self:{iconColorDisabled:l}}=b.value,[m,x,R,K]=vt(l);return{textColorTextDisabled:`rgb(${m}, ${x}, ${R})`,opacityDisabled:`${K}`}})})},render(){const{mergedClsPrefix:a,$slots:h}=this,p=()=>w(Fe,{text:!0,disabled:!this.minusable||this.mergedDisabled||this.readonly,focusable:!1,theme:this.mergedTheme.peers.Button,themeOverrides:this.mergedTheme.peerOverrides.Button,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleMinusClick,onMousedown:this.handleMinusMousedown,ref:"minusButtonInstRef"},{icon:()=>ze(h["minus-icon"],()=>[w($e,{clsPrefix:a},{default:()=>w(Mt,null)})])}),f=()=>w(Fe,{text:!0,disabled:!this.addable||this.mergedDisabled||this.readonly,focusable:!1,theme:this.mergedTheme.peers.Button,themeOverrides:this.mergedTheme.peerOverrides.Button,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleAddClick,onMousedown:this.handleAddMousedown,ref:"addButtonInstRef"},{icon:()=>ze(h["add-icon"],()=>[w($e,{clsPrefix:a},{default:()=>w(gt,null)})])});return w("div",{class:[`${a}-input-number`,this.rtlEnabled&&`${a}-input-number--rtl`]},w(B,{ref:"inputInstRef",autofocus:this.autofocus,status:this.mergedStatus,bordered:this.mergedBordered,loading:this.loading,value:this.displayedValue,onUpdateValue:this.handleUpdateDisplayedValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,builtinThemeOverrides:this.inputThemeOverrides,size:this.mergedSize,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,readonly:this.readonly,textDecoration:this.displayedValueInvalid?"line-through":void 0,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onClear:this.handleClear,clearable:this.clearable,internalLoadingBeforeSuffix:!0},{prefix:()=>{var b;return this.showButton&&this.buttonPlacement==="both"?[p(),_e(h.prefix,C=>C?w("span",{class:`${a}-input-number-prefix`},C):null)]:(b=h.prefix)===null||b===void 0?void 0:b.call(h)},suffix:()=>{var b;return this.showButton?[_e(h.suffix,C=>C?w("span",{class:`${a}-input-number-suffix`},C):null),this.buttonPlacement==="right"?p():null,f()]:(b=h.suffix)===null||b===void 0?void 0:b.call(h)}}))}}),Ft=Ne([Ne("@keyframes spin-rotate",`
 from {
 transform: rotate(0);
 }
 to {
 transform: rotate(360deg);
 }
 `),q("spin-container",{position:"relative"},[q("spin-body",`
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[bt()])]),q("spin-body",`
 display: inline-flex;
 align-items: center;
 justify-content: center;
 flex-direction: column;
 `),q("spin",`
 display: inline-flex;
 height: var(--n-size);
 width: var(--n-size);
 font-size: var(--n-size);
 color: var(--n-color);
 `,[Ke("rotate",`
 animation: spin-rotate 2s linear infinite;
 `)]),q("spin-description",`
 display: inline-block;
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 margin-top: 8px;
 `),q("spin-content",`
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 pointer-events: all;
 `,[Ke("spinning",`
 user-select: none;
 -webkit-user-select: none;
 pointer-events: none;
 opacity: var(--n-opacity-spinning);
 `)])]),Kt={small:20,medium:18,large:16},Ot=Object.assign(Object.assign({},fe.props),{description:String,stroke:String,size:{type:[String,Number],default:"medium"},show:{type:Boolean,default:!0},strokeWidth:Number,rotate:{type:Boolean,default:!0},spinning:{type:Boolean,validator:()=>!0,default:void 0},delay:Number}),Et=Y({name:"Spin",props:Ot,setup(a){const{mergedClsPrefixRef:h,inlineThemeDisabled:p}=We(a),f=fe("Spin","-spin",Ft,yt,a,h),b=$(()=>{const{size:o}=a,{common:{cubicBezierEaseInOut:N},self:s}=f.value,{opacitySpinning:M,color:F,textColor:T}=s,E=typeof o=="number"?xt(o):s[wt("size",o)];return{"--n-bezier":N,"--n-opacity-spinning":M,"--n-size":E,"--n-color":F,"--n-text-color":T}}),C=p?Ct("spin",$(()=>{const{size:o}=a;return typeof o=="number"?String(o):o[0]}),b,a):void 0,y=kt(a,["spinning","show"]),S=U(!1);return It(o=>{let N;if(y.value){const{delay:s}=a;if(s){N=window.setTimeout(()=>{S.value=!0},s),o(()=>{clearTimeout(N)});return}}S.value=y.value}),{mergedClsPrefix:h,active:S,mergedStrokeWidth:$(()=>{const{strokeWidth:o}=a;if(o!==void 0)return o;const{size:N}=a;return Kt[typeof N=="number"?"medium":N]}),cssVars:p?void 0:b,themeClass:C==null?void 0:C.themeClass,onRender:C==null?void 0:C.onRender}},render(){var a,h;const{$slots:p,mergedClsPrefix:f,description:b}=this,C=p.icon&&this.rotate,y=(b||p.description)&&w("div",{class:`${f}-spin-description`},b||((a=p.description)===null||a===void 0?void 0:a.call(p))),S=p.icon?w("div",{class:[`${f}-spin-body`,this.themeClass]},w("div",{class:[`${f}-spin`,C&&`${f}-spin--rotate`],style:p.default?"":this.cssVars},p.icon()),y):w("div",{class:[`${f}-spin-body`,this.themeClass]},w(Dt,{clsPrefix:f,style:p.default?"":this.cssVars,stroke:this.stroke,"stroke-width":this.mergedStrokeWidth,class:`${f}-spin`}),y);return(h=this.onRender)===null||h===void 0||h.call(this),p.default?w("div",{class:[`${f}-spin-container`,this.themeClass],style:this.cssVars},w("div",{class:[`${f}-spin-content`,this.active&&`${f}-spin-content--spinning`]},p),w(St,{name:"fade-in-transition"},{default:()=>this.active?S:null})):S}}),jt={class:"border-none shadow-none flex flex-col gap-2 p-2 rounded-lg"},Ht={class:"post-heading mb-1"},Lt={class:"gtext text-2xl font-bold underlined"},qt={style:{display:"flex","justify-content":"flex-end"}},Wt=Y({__name:"Add",setup(a){const{isMobile:h}=ve(),p=$(()=>h?24:12),f=Pe(),b=Ae(),C=Ve(),y=U(null),S=U(!1),o=U(f.initState()),N={name:[{required:!0,message:t("common.nameRequired"),trigger:["input","blur"]}],modelCode:[{required:!0,message:t("common.modelCodeRequired"),trigger:["input","blur"]}],companyId:[{required:!0,message:t("common.companyIdRequired"),trigger:["input","blur"]}]},s=[{label:t("common.text"),value:"Text"},{label:t("common.image"),value:"Image"},{label:t("common.audio"),value:"Audio"},{label:t("common.video"),value:"Video"},{label:t("common.documents"),value:"Documents"}],M=U([]);async function F(){try{await b.fetchDataAction({limit:1e3,offset:0}),b.listCompanies=await Promise.all(b.listCompanies.map(async D=>{if(D.logoUrl)try{D.logoUrl=await Te(b.bucket,D.logoUrl)}catch(r){console.error(`Failed to fetch image for company ${D.name}:`,r)}return{...D}})),M.value=b.listCompanies.map(D=>({label:D.name,value:D.id,logoUrl:D.logoUrl}))}catch(D){console.error(t("chat.dataFetchError"),D.message)}}ge(F);async function T(){try{S.value=!0,await f.insertDataAction(o.value),S.value=!1,f.showModelAdd=!1,C.success(t("common.addSuccess"))}catch(D){S.value=!1,console.error(t("common.addFailed"),D.message),C.error(t("common.addFailed"))}}function E(){return!o.value.name||!o.value.modelCode||!o.value.companyId||S.value}function g(D){var r;D.preventDefault(),(r=y.value)==null||r.validate(i=>{i?C.error(t("auth.fillAllField")):T()})}return(D,r)=>(G(),ie("div",jt,[P("div",Ht,[P("div",Lt,z(e(t)("common.addNew")),1)]),n(e(Xe),{ref_key:"formRef",ref:y,model:o.value,rules:N,size:"large"},{default:d(()=>[P("div",null,[n(e(Ge),{span:p.value,"x-gap":24},{default:d(()=>[n(e(k),{span:p.value,path:"companyId",label:e(t)("common.company")},{default:d(()=>[n(e(ae),{value:o.value.companyId,"onUpdate:value":r[0]||(r[0]=i=>o.value.companyId=i),options:M.value,placeholder:e(t)("common.selectCompany"),clearable:""},null,8,["value","options","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"name",label:e(t)("common.name")},{default:d(()=>[n(e(B),{value:o.value.name,"onUpdate:value":r[1]||(r[1]=i=>o.value.name=i),onKeyup:V(g,["enter"]),placeholder:e(t)("common.name"),clearable:"",onKeydown:r[2]||(r[2]=V(W(()=>{},["prevent"]),["enter"]))},null,8,["value","onKeyup","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"modelCode",label:e(t)("common.modelCode")},{default:d(()=>[n(e(B),{value:o.value.modelCode,"onUpdate:value":r[3]||(r[3]=i=>o.value.modelCode=i),onKeyup:V(g,["enter"]),placeholder:e(t)("common.modelCode"),clearable:"",onKeydown:r[4]||(r[4]=V(W(()=>{},["prevent"]),["enter"]))},null,8,["value","onKeyup","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"description",label:e(t)("common.description")},{default:d(()=>[n(e(B),{value:o.value.description,"onUpdate:value":r[5]||(r[5]=i=>o.value.description=i),onKeyup:V(g,["enter"]),placeholder:e(t)("common.description"),clearable:"",onKeydown:r[6]||(r[6]=V(W(()=>{},["prevent"]),["enter"]))},null,8,["value","onKeyup","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"version",label:e(t)("common.version")},{default:d(()=>[n(e(B),{value:o.value.version,"onUpdate:value":r[7]||(r[7]=i=>o.value.version=i),onKeyup:V(g,["enter"]),placeholder:e(t)("common.version"),clearable:"",onKeydown:r[8]||(r[8]=V(W(()=>{},["prevent"]),["enter"]))},null,8,["value","onKeyup","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"inputData",label:e(t)("common.inputData")},{default:d(()=>[n(e(ae),{value:o.value.inputData,"onUpdate:value":r[9]||(r[9]=i=>o.value.inputData=i),options:s,multiple:"",placeholder:e(t)("common.selectInputData"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"outputData",label:e(t)("common.outputData")},{default:d(()=>[n(e(ae),{value:o.value.outputData,"onUpdate:value":r[10]||(r[10]=i=>o.value.outputData=i),options:s,multiple:"",placeholder:e(t)("common.selectOutputData"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:12,path:"maxTokens",label:e(t)("common.maxTokens")},{default:d(()=>[n(e(O),{value:o.value.maxTokens,"onUpdate:value":r[11]||(r[11]=i=>o.value.maxTokens=i),placeholder:e(t)("common.maxTokens"),min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"temperature",label:e(t)("common.temperature")},{default:d(()=>[n(e(O),{value:o.value.temperature,"onUpdate:value":r[12]||(r[12]=i=>o.value.temperature=i),placeholder:e(t)("common.temperature"),step:"0.01",min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"topP",label:e(t)("common.topP")},{default:d(()=>[n(e(O),{value:o.value.topP,"onUpdate:value":r[13]||(r[13]=i=>o.value.topP=i),placeholder:e(t)("common.topP"),step:"0.01",min:"0",max:"1"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"topK",label:e(t)("common.topK")},{default:d(()=>[n(e(O),{value:o.value.topK,"onUpdate:value":r[14]||(r[14]=i=>o.value.topK=i),placeholder:e(t)("common.topK"),min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"repetitionPenalty",label:e(t)("common.repetitionPenalty")},{default:d(()=>[n(e(O),{value:o.value.repetitionPenalty,"onUpdate:value":r[15]||(r[15]=i=>o.value.repetitionPenalty=i),placeholder:e(t)("common.repetitionPenalty"),step:"0.01",min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:p.value,path:"stop",label:e(t)("common.stop")},{default:d(()=>[n(e(B),{value:o.value.stop,"onUpdate:value":r[16]||(r[16]=i=>o.value.stop=i),placeholder:e(t)("common.stopPlaceholder"),type:"textarea",autosize:{minRows:2,maxRows:4}},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"stream",label:e(t)("common.stream")},{default:d(()=>[n(e(re),{value:o.value.stream,"onUpdate:value":r[17]||(r[17]=i=>o.value.stream=i),size:"large"},null,8,["value"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"isActivate",label:e(t)("common.isActivate")},{default:d(()=>[n(e(re),{value:o.value.isActivate,"onUpdate:value":r[18]||(r[18]=i=>o.value.isActivate=i),size:"large"},null,8,["value"])]),_:1},8,["span","label"])]),_:1},8,["span"])]),P("div",qt,[n(e(Q),{type:"primary",style:{width:"100%"},size:"large",loading:S.value,disabled:E(),onClick:g},{default:d(()=>[he(z(e(t)("common.addNew")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["model"])]))}}),Gt={class:"border-none shadow-none flex flex-col gap-2 p-2 rounded-lg"},Xt={class:"post-heading mb-1"},Jt={class:"gtext text-2xl font-bold underlined"},Qt={style:{display:"flex","justify-content":"flex-end"}},Yt=Y({__name:"Update",props:{item:{}},setup(a){const h=a,{isMobile:p}=ve(),f=$(()=>p?24:12),b=Pe(),C=Ae(),y=Ve(),S=U(null),o=U(!1),N=U({...h.item}),s=U({...h.item}),M={name:[{required:!0,message:t("common.nameRequired"),trigger:["input","blur"]}],modelCode:[{required:!0,message:t("common.modelCodeRequired"),trigger:["input","blur"]}],companyId:[{required:!0,message:t("common.companyIdRequired"),trigger:["input","blur"]}]};async function F(){try{o.value=!0,await b.updateDataAction(s.value),o.value=!1,b.showModelUpdate=!1,y.success(t("common.updateSuccess"))}catch(i){o.value=!1,console.error(t("common.updateFailed"),i.message),y.error(t("common.updateFailed"),i.message)}}const T=[{label:t("common.text"),value:"Text"},{label:t("common.image"),value:"Image"},{label:t("common.audio"),value:"Audio"},{label:t("common.video"),value:"Video"},{label:t("common.documents"),value:"Documents"}],E=$(()=>o.value||!s.value.name||!s.value.modelCode||!s.value.companyId||JSON.stringify(s.value)===JSON.stringify(N.value));function g(i){var u;i.preventDefault(),(u=S.value)==null||u.validate(c=>{c?y.error(t("auth.fillAllField")):F()})}const D=U([]);async function r(){try{await C.fetchDataAction({limit:1e3,offset:0}),C.listCompanies=await Promise.all(C.listCompanies.map(async i=>{if(i.logoUrl)try{i.logoUrl=await Te(C.bucket,i.logoUrl)}catch(u){console.error(`Failed to fetch image for company ${i.name}:`,u)}return{...i}})),D.value=C.listCompanies.map(i=>({label:i.name,value:i.id,logoUrl:i.logoUrl}))}catch(i){console.error(t("chat.dataFetchError"),i.message)}finally{}}return ge(r),(i,u)=>(G(),ie("div",Gt,[P("div",Xt,[P("div",Jt,z(e(t)("common.update")),1)]),n(e(Xe),{ref_key:"formRef",ref:S,model:s.value,rules:M,size:"large"},{default:d(()=>[P("div",null,[n(e(Ge),{span:f.value,"x-gap":24},{default:d(()=>[n(e(k),{span:f.value,path:"companyId",label:e(t)("common.company")},{default:d(()=>[n(e(ae),{value:s.value.companyId,"onUpdate:value":u[0]||(u[0]=c=>s.value.companyId=c),options:e(C).listCompanies.map(c=>({label:c.name,value:c.id})),placeholder:e(t)("common.selectCompany"),clearable:""},null,8,["value","options","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"name",label:e(t)("common.name")},{default:d(()=>[n(e(B),{value:s.value.name,"onUpdate:value":u[1]||(u[1]=c=>s.value.name=c),placeholder:e(t)("common.name"),clearable:"",onKeydown:u[2]||(u[2]=V(W(()=>{},["prevent"]),["enter"])),onKeyup:V(g,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"modelCode",label:e(t)("common.modelCode")},{default:d(()=>[n(e(B),{value:s.value.modelCode,"onUpdate:value":u[3]||(u[3]=c=>s.value.modelCode=c),placeholder:e(t)("common.modelCode"),clearable:"",onKeydown:u[4]||(u[4]=V(W(()=>{},["prevent"]),["enter"])),onKeyup:V(g,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"description",label:e(t)("common.description")},{default:d(()=>[n(e(B),{value:s.value.description,"onUpdate:value":u[5]||(u[5]=c=>s.value.description=c),placeholder:e(t)("common.description"),clearable:"",onKeydown:u[6]||(u[6]=V(W(()=>{},["prevent"]),["enter"])),onKeyup:V(g,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"version",label:e(t)("common.version")},{default:d(()=>[n(e(B),{value:s.value.version,"onUpdate:value":u[7]||(u[7]=c=>s.value.version=c),placeholder:e(t)("common.version"),clearable:"",onKeydown:u[8]||(u[8]=V(W(()=>{},["prevent"]),["enter"])),onKeyup:V(g,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"inputData",label:e(t)("common.inputData")},{default:d(()=>[n(e(ae),{value:s.value.inputData,"onUpdate:value":u[9]||(u[9]=c=>s.value.inputData=c),options:T,multiple:"",placeholder:e(t)("common.selectInputData"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"outputData",label:e(t)("common.outputData")},{default:d(()=>[n(e(ae),{value:s.value.outputData,"onUpdate:value":u[10]||(u[10]=c=>s.value.outputData=c),options:T,multiple:"",placeholder:e(t)("common.selectOutputData"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:12,path:"maxTokens",label:e(t)("common.maxTokens")},{default:d(()=>[n(e(O),{value:s.value.maxTokens,"onUpdate:value":u[11]||(u[11]=c=>s.value.maxTokens=c),placeholder:e(t)("common.maxTokens"),min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"temperature",label:e(t)("common.temperature")},{default:d(()=>[n(e(O),{value:s.value.temperature,"onUpdate:value":u[12]||(u[12]=c=>s.value.temperature=c),placeholder:e(t)("common.temperature"),step:"0.01",min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"topP",label:e(t)("common.topP")},{default:d(()=>[n(e(O),{value:s.value.topP,"onUpdate:value":u[13]||(u[13]=c=>s.value.topP=c),placeholder:e(t)("common.topP"),step:"0.01",min:"0",max:"1"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"topK",label:e(t)("common.topK")},{default:d(()=>[n(e(O),{value:s.value.topK,"onUpdate:value":u[14]||(u[14]=c=>s.value.topK=c),placeholder:e(t)("common.topK"),type:"number",min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"repetitionPenalty",label:e(t)("common.repetitionPenalty")},{default:d(()=>[n(e(O),{value:s.value.repetitionPenalty,"onUpdate:value":u[15]||(u[15]=c=>s.value.repetitionPenalty=c),placeholder:e(t)("common.repetitionPenalty"),type:"number",step:"0.01",min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:f.value,path:"stop",label:e(t)("common.stop")},{default:d(()=>[n(e(B),{value:s.value.stop,"onUpdate:value":u[16]||(u[16]=c=>s.value.stop=c),placeholder:e(t)("common.stopPlaceholder"),type:"textarea",autosize:{minRows:2,maxRows:4}},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"stream",label:e(t)("common.stream")},{default:d(()=>[n(e(re),{value:s.value.stream,"onUpdate:value":u[17]||(u[17]=c=>s.value.stream=c),size:"large"},null,8,["value"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"isActivate",label:e(t)("common.isActivate")},{default:d(()=>[n(e(re),{value:s.value.isActivate,"onUpdate:value":u[18]||(u[18]=c=>s.value.isActivate=c),size:"large"},null,8,["value"])]),_:1},8,["span","label"])]),_:1},8,["span"])]),P("div",Qt,[n(e(Q),{type:"primary",style:{width:"100%"},size:"large",loading:o.value,disabled:E.value,onClick:g},{default:d(()=>[he(z(e(t)("common.update")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["model"])]))}}),Zt={key:1,class:"flex gap-4 item-center"},ea={class:"flex flex-col"},ta={class:"font-bold text-base"},aa={class:"w-36"},la={key:2},na=Y({__name:"Card",props:{companyId:{}},setup(a){const h=a,p=Ae(),f=U(null),b=U(!1);async function C(){b.value=!0;try{await p.fetchDataAction({limit:1e3,offset:0}),p.listCompanies=await Promise.all(p.listCompanies.map(async o=>{if(o.logoUrl)try{o.logoUrl=await Te(p.bucket,o.logoUrl)}catch(N){console.error(`Failed to fetch image for company ${o.name}:`,N)}return{...o}}))}catch(o){console.error(t("chat.dataFetchError"),o.message)}finally{b.value=!1}}async function y(){let o=p.listCompanies.find(N=>N.id===h.companyId);o||(await C(),o=p.listCompanies.find(N=>N.id===h.companyId)),o?f.value=o:console.error(`Company with ID ${h.companyId} not found`)}ge(y);const S=$(()=>{var o;return(o=f.value)!=null&&o.isActivate?"success":"error"});return ve(),(o,N)=>b.value?(G(),Re(e(Et),{key:0,size:"small"})):f.value?(G(),ie("div",Zt,[n(e(Nt),{dot:"",processing:!1,type:S.value},{default:d(()=>[n(e(Ut),{round:"",size:"medium",src:f.value.logoUrl},null,8,["src"])]),_:1},8,["type"]),P("div",ea,[P("div",ta,[n(e(Rt),{"line-clamp":1},{tooltip:d(()=>[P("div",aa,z(f.value.name),1)]),default:d(()=>[he(z(f.value.name)+" ",1)]),_:1})])])])):(G(),ie("div",la,[P("p",null,z(e(t)("common.companyNotFound")),1)]))}}),oa={class:"container_dashboard"},sa={class:"header_dashboard"},ia={class:"flex gap-2 justify-end items-center my-2 mt-8"},ra={class:"flex gap-2 items-center"},ua={class:"hidden md:block"},da={class:"flex gap-2 items-center"},ca={class:"hidden md:block"},ya=Y({__name:"List",setup(a){const{iconRender:h}=At(),p=U(!1),f=U(!1),b=U(!0),C=U(!1),y=Pe(),S=U([]),{isMobile:o}=ve(),N=Pt(),s=Ve(),M=U(null),F=$(()=>{const v=(g.page-1)*g.pageSize,I=v+g.pageSize;return y.listModels.slice(v,I)}),T=U(10),E=$(()=>y.countTotalData),g=pe({page:1,pageCount:$(()=>Math.ceil(E.value/T.value)),pageSize:T.value});async function D(v){y.showModelUpdate=!0,M.value=v}const r=pe({title:t("common.company"),key:"company",render(v){return w(na,{companyId:v.companyId})}}),i=pe([{title:t("common.name"),key:"name",align:"center",render(v){return w(te,{strong:!0},{default:()=>v.name})}},{title:t("common.modelCode"),key:"modelCode",align:"center",render(v){return w(te,{type:"info"},{default:()=>v.modelCode})},ellipsis:!0},{title:t("common.description"),key:"description",align:"center",render(v){return w(te,{},{default:()=>v.description||"N/A"})},ellipsis:!0},{title:t("common.version"),key:"version",align:"center",render(v){return w(te,{},{default:()=>v.version||"N/A"})},ellipsis:!0},{title:t("common.isActivate"),key:"isActivate",align:"center",render(v){return w(re,{value:v.isActivate,disabled:!0})}},{title:t("common.createdAt"),key:"createdAt",align:"center",render(v){return w(te,{},{default:()=>new Date(v.createdAt).toLocaleString()})}},{title:t("common.updatedAt"),key:"updatedAt",align:"center",render(v){return w(te,{},{default:()=>new Date(v.updatedAt).toLocaleString()})}}]),u=pe([{type:"selection"},r,...i,{title:t("common.actions"),key:"actions",align:"center",width:100,render(v){return w("div",{class:"flex gap-1"},[w(Q,{strong:!0,tertiary:!0,size:"small",loading:f.value,style:"border-radius:100%",onClick:async()=>{try{await D(v)}catch(I){console.error(t("common.updateFailed"),I.message)}}},{default:()=>w(h({icon:"fluent:edit-32-regular",color:"blue"}))}),w(Q,{strong:!0,tertiary:!0,size:"small",loading:p.value,style:"border-radius:100%",onClick:async()=>{try{de(v)}catch(I){console.error(t("common.deleteFailed"),I.message)}}},{default:()=>w(h({icon:"fluent:delete-32-regular",color:"red"}))})])}}]);async function c(){try{b.value=!0;const{page:v,pageSize:I}=g;await y.fetchDataAction({limit:I,offset:(v-1)*I})}catch(v){C.value=!0,console.error(t("chat.dataFetchError"),v.message)}finally{b.value=!1}}ge(async()=>{await c()});const ue=v=>v.id;function de(v){const I=N.warning({title:t("common.deleteConfirmation"),content:t("common.deleteConfirmationMessage"),positiveText:t("common.yes"),negativeText:t("common.no"),onPositiveClick:async()=>{try{I.loading=!0,await y.deleteDataAction(v.id),s.success(t("common.deleteSuccess"));const A=(g.page-1)*g.pageSize,le=A+g.pageSize;y.listModels.slice(A,le).length===0&&g.page>1&&(g.page-=1),await c()}catch{I.loading=!1,s.error(t("common.deleteFailed"))}finally{I.loading=!1}}})}function X(v){g.page=v,c()}function _(v){S.value=v}function H(){const v=N.warning({title:t("common.deleteConfirmation"),content:t("common.deleteConfirmationMessage"),positiveText:t("common.yes"),negativeText:t("common.no"),onPositiveClick:async()=>{try{v.loading=!0;const I=S.value.map(ye=>y.deleteDataAction(String(ye)));await Promise.all(I),s.success(t("common.deleteSuccess")),await c();const A=(g.page-1)*g.pageSize,le=A+g.pageSize;y.listModels.slice(A,le).length===0&&g.page>1&&(g.page-=1),await c()}catch(I){console.error(t("common.deleteFailed"),I.message),s.error(t("common.deleteFailed"))}finally{v.loading=!1}}})}return(v,I)=>(G(),ie("div",oa,[P("div",sa,z(e(t)("common.models")),1),P("div",null,[P("div",ia,[n(e(Oe),{vertical:""},{default:d(()=>[n(e(Oe),{justify:"space-between"},{default:d(()=>[n(e(Q),{onClick:I[0]||(I[0]=A=>e(y).showModelAdd=!0),type:"primary"},{default:d(()=>[P("div",ra,[n(e(Ee),{icon:"mdi:add-bold",class:"text-base"}),P("div",ua,z(e(t)("common.add")),1)])]),_:1}),n(e(Q),{strong:"",secondary:"",type:"error",disabled:!(S.value.length>0),onClick:H},{default:d(()=>[P("div",da,[n(e(Ee),{icon:"fluent:delete-32-regular",class:"text-base"}),P("div",ca,z(e(t)("common.delete")),1)])]),_:1},8,["disabled"])]),_:1}),C.value?(G(),Re(e(Tt),{key:1,status:"warning",title:"Error",description:"Error fetching data."},{footer:d(()=>[n(e(Q),{onClick:c},{default:d(()=>[he(z(e(t)("common.tryAgain")),1)]),_:1})]),_:1})):(G(),Re(e(Vt),{key:0,remote:"","min-height":e(o)?380:540,"max-height":e(o)?400:700,size:(e(o),"small"),"checked-row-keys":S.value,"onUpdate:checkedRowKeys":[I[1]||(I[1]=A=>S.value=A),_],striped:"",loading:b.value,columns:u,data:F.value,"onUpdate:page":X,pagination:g,"row-key":ue},null,8,["min-height","max-height","size","checked-row-keys","loading","columns","data","pagination"])),n(e(je),{show:e(y).showModelAdd,"onUpdate:show":I[2]||(I[2]=A=>e(y).showModelAdd=A),"mask-closable":!1,"auto-focus":!1,preset:"card",style:{width:"95%","max-width":"800px"}},{default:d(()=>[n(Wt)]),_:1},8,["show"]),n(e(je),{show:e(y).showModelUpdate,"onUpdate:show":I[3]||(I[3]=A=>e(y).showModelUpdate=A),"mask-closable":!1,"auto-focus":!1,preset:"card",style:{width:"95%","max-width":"800px"}},{default:d(()=>[n(Yt,{item:M.value},null,8,["item"])]),_:1},8,["show"])]),_:1})])])]))}});export{ya as default};
